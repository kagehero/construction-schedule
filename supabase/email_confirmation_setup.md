# メール確認設定について

## 概要

Supabaseのメール確認設定は、**一度設定すれば全てのユーザーに適用されます**。ユーザーごとに毎回設定する必要はありません。

## 設定方法

### 方法1: プロジェクト全体でメール確認を無効にする（推奨・開発環境）

この設定は**一度行えば、全ての新規ユーザーに適用されます**。

1. Supabaseダッシュボードにアクセス
2. **Authentication** → **Settings** に移動
3. **Auth Providers** セクションで **Email** を選択
4. **「Enable email confirmations」** のチェックを**外す**（無効にする）
5. 設定を保存

**効果:**
- この設定後、**全ての新規登録ユーザー**が自動的に確認済みになります
- メール確認リンクをクリックする必要がなくなります
- 登録後すぐにログイン可能になります

### 方法2: 個別ユーザーを確認済みにする

既に登録済みのユーザーに対して、個別に確認済みにする設定です。

1. Supabaseダッシュボード → **Authentication** → **Users**
2. 該当ユーザーを選択
3. **「Auto Confirm User」** にチェックを入れる
4. 保存

**注意:** この方法は**既存ユーザーごと**に設定が必要です。新規ユーザーには適用されません。

### 方法3: ユーザー作成時に自動確認する

Supabaseダッシュボードから手動でユーザーを作成する場合：

1. **Authentication** → **Users** → **Add user**
2. ユーザー情報を入力
3. **「Auto Confirm User」** にチェックを入れる
4. ユーザーを作成

**注意:** この方法は**手動で作成するユーザー**にのみ適用されます。アプリケーションから登録するユーザーには適用されません。

## 推奨設定（開発環境）

開発環境では、**方法1（プロジェクト全体でメール確認を無効にする）**を推奨します。

### 理由：
- ✅ 一度設定すれば、全ての新規ユーザーに自動適用
- ✅ ユーザーごとに個別設定が不要
- ✅ 開発・テストがスムーズ
- ✅ メールサーバーの設定が不要

### 本番環境での注意：

本番環境では、セキュリティのためメール確認を有効にすることを推奨します：
- メール確認を有効にする
- メールサーバー（SMTP）を設定する
- ユーザーがメール確認リンクをクリックしてからログイン可能にする

## よくある質問

### Q: ユーザーがログインするたびに設定が必要ですか？

**A: いいえ、必要ありません。**
- プロジェクト全体の設定（方法1）は一度行えば、全てのユーザーに適用されます
- 個別ユーザーの設定（方法2）も一度行えば、そのユーザーは永続的に確認済みになります

### Q: 新規登録したユーザーも自動的に確認済みになりますか？

**A: 方法1を設定していれば、はい。**
- 「Enable email confirmations」を無効にしていれば、全ての新規登録ユーザーが自動的に確認済みになります
- アプリケーションから登録するユーザーも、手動で作成するユーザーも同様です

### Q: 既存のユーザーにも設定が必要ですか？

**A: 方法1を設定する前から存在していたユーザーには、方法2で個別に設定が必要です。**
- 方法1を設定する前に登録したユーザーは、個別に「Auto Confirm User」を有効にする必要があります
- 方法1を設定した後に登録したユーザーは、自動的に確認済みになります

## 設定の確認方法

現在の設定を確認するには：

1. Supabaseダッシュボード → **Authentication** → **Settings**
2. **Auth Providers** → **Email** を確認
3. **「Enable email confirmations」** の状態を確認
   - ✅ チェックあり = メール確認が必要
   - ❌ チェックなし = メール確認が不要（自動確認）

## トラブルシューティング

### 「メールアドレスが確認されていません」エラーが出る場合

1. **設定を確認**
   - Authentication → Settings で「Enable email confirmations」が無効になっているか確認
   
2. **既存ユーザーを確認済みにする**
   - Authentication → Users で該当ユーザーを選択
   - 「Auto Confirm User」にチェックを入れる

3. **開発サーバーを再起動**
   - 設定変更後、Next.jsの開発サーバーを再起動してください
